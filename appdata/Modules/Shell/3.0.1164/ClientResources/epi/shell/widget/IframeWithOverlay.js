//>>built
require({cache:{"url:epi/shell/widget/templates/IframeWithOverlay.html":"<div data-dojo-attach-point=\"containerNode\" class=\"epi-editorViewport\">\r\n    <div data-dojo-attach-point=\"scroller\" class=\"epi-editorViewport-center\">\r\n        <div data-dojo-attach-point=\"previewContainer\" class=\"epi-editorViewport-previewBox\"  data-dojo-props=\"region: 'center'\">\r\n            <iframe data-dojo-attach-point=\"iframe\" data-dojo-type=\"epi/local/AutoResizingIframe\" data-dojo-props=\"autoFit : false\"></iframe>\r\n            <div data-dojo-attach-point=\"overlay\" data-dojo-type=\"epi/shell/widget/overlay/OverlayContainer\"></div>\r\n            <div data-dojo-attach-point=\"scrollSizer\" class=\"epi-editorViewport-scrollSizer\"></div>\r\n        </div>\r\n    </div>\r\n</div>"}});define("epi/shell/widget/IframeWithOverlay",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","dojo/number","dojo/aspect","dojo/dom-geometry","dojo/dom-style","dojo/dom-construct","dojo/dom-class","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","./Iframe","./_AutoResizingIframeMixin","./_ScrollbarMeasurementMixin","./_DynamicStyleSheetIframeMixin","./overlay/OverlayContainer","epi/shell/layout/_LayoutWidget","epi/shell/widget/DelayableStandby","dojo/text!./templates/IframeWithOverlay.html"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,_12,_13,_14){_1("epi/local/AutoResizingIframe",[_d,_e,_10]);return _1([_12,_b,_c,_f],{templateString:_14,autoResize:true,previewSize:null,devicePreviewClass:"",previewClass:"",standbySettings:{delayTime:3000,duration:350},postCreate:function(){this.inherited(arguments);this.overlay.set("target",this.iframe);this._setupStandby();this.connect(this.iframe,"onUnload",function(){this._standby.show();});this.connect(this.iframe,"onLoad",function(url){_a.toggle(this.scroller,"epi-editorViewport-preview-external",!this.iframe.isInspectable());this._standby.hide();});},startup:function(){if(this._started){return;}this.inherited(arguments);this._setCenterViewport(this._availableViewport||this._contentBox||_7.getContentBox(this.containerNode),true);},destroy:function(){this._standby.destroy();this._standby=null;this.inherited(arguments);},addChild:function(_15,_16){function _17(){this.layout();_3.forEach(_15.getChildren(),function(_18){_18.connect(_18,"onLayoutChanged",_2.hitch(this,function(){if(_15.open){this.layout();}}));},this);};function _19(){this._resetScroll();_8.set(this.scroller,{width:""});this._setCenterViewport(this._contentBox);};_15.connect(_15,"onAfterShow",_2.hitch(this,_17));_15.connect(_15,"onAfterHide",_2.hitch(this,_19));this.connect(this,"onLayoutChanged",_2.hitch(this,function(){if(_15.open){this.scrollIntoView(_15.overlayItem);}else{_2.hitch(this,_19)();}}));this.inherited(arguments);},layout:function(_1a){if(!this._contentBox){this._pendingLayout=true;return;}this._layoutChildren(_1a);this.inherited(arguments);},_layoutChildren:function(_1b){if(_1b){this._resetScroll();}this._positionChildren();this._setCenterViewport(this._availableViewport,_1b);},_positionChildren:function(){var _1c=this.get("centerSize");this._availableViewport=_2.mixin({},this._contentBox);_8.set(this.scroller,{width:""});var _1d=this.getScrollbars(this.scroller);_3.forEach(this.getChildren(),function(_1e){if(_1e===this.iframe||_1e===this.overlay||_1e.open===false||_1e.visible===false){return;}var _1f;switch(_1e.region){case "leading":if(_1e.resize){_1e.resize({t:0,l:0,h:this._contentBox.h-_1d.x});}_1f=_7.position(_1e.domNode);this._availableViewport.w-=_1f.w;this._availableViewport.l+=_1f.w;break;case "trailing":var _20=_2.hitch(this,function(){if(_1e.resize){if(!_1e._computedStyle){_1e._computedStyle=_8.getComputedStyle(_1e.domNode);}_1f=_7.getMarginBox(_1e.domNode,_1e._computedStyle);_1e.resize({t:0,h:this._contentBox.h-_1d.x});_8.set(_1e.domNode,{right:_1d.y+"px"});_8.set(this.scroller,{width:(this._availableViewport.w-_1f.w)+"px"});this._availableViewport.w-=_1f.w+_1d.y;}});_20();break;case "center":if(_1e.resize){_1e.resize(_1c);}break;default:break;}},this);},_setCenterViewport:function(_21,_22){var _23=this.get("centerSize")||_7.getContentBox(this.previewContainer),_24,top,_25;this.previewContainer._computedStyle=this.previewContainer._computedStyle||_8.getComputedStyle(this.previewContainer);_24=_7.getPadBorderExtents(this.previewContainer,this.previewContainer._computedStyle);top=_21.h>_23.h?_5.round((_21.h-_23.h)/2):0;_25=_21.w>_23.w?_5.round((_21.w-_23.w)/2):0;_8.set(this.previewContainer,{top:top-_24.t+"px",left:_25-_24.l+"px",width:_23.w+"px",height:_23.h+"px"});this.iframe.resize(_23,!!_22);this.emit("viewportresized");},onViewportPullDown:function(){this.emit("viewportpulldown");},scrollIntoView:function(_26){var _27,_28,_29,_2a=16;if(this.iframe.isLoading||!this._contentBox){return;}this._layoutChildren();if((!this.autoResize&&this.previewSize.w<this._availableViewport.w)){return;}_27=_26.get("position");_28=_27.x+_27.w+_2a-this.scroller.scrollLeft-this._availableViewport.w;_29=this.previewContainer.clientWidth+_28;_8.set(this.scrollSizer,{width:_29+"px"});this.previewContainer.scrollLeft=_28;this._positionChildren(this.get("centerSize"));},_resetScroll:function(){_8.set(this.scrollSizer,{width:"1px"});},_setupStandby:function(){var _2b=_2.mixin(this.standbySettings,{target:this.scroller});this._standby=new _13(_2b).placeAt(this.domNode,"last");this._standby.startup();},_getCenterSizeAttr:function(){return this.previewSize||this._contentBox;},_setPreviewSizeAttr:function(_2c){this.autoResize=!_2c;this.previewSize=_2c;_a.toggle(this.scroller,"epi-editorViewport-preview",!this.autoResize);this.layout();},_setDevicePreviewClassAttr:function(_2d){if(_2d){_a.replace(this.scroller,_2d,this.devicePreviewClass);}else{_a.remove(this.scroller,this.devicePreviewClass);}this._set("devicePreviewClass",_2d);},_setPreviewClassAttr:function(_2e){if(_2e){_a.replace(this.scroller,_2e,this.previewClass);}else{_a.remove(this.scroller,this.previewClass);}this._set("previewClass",_2e);},showDelay:function(_2f){this._standby.show(_2f);},hideDelay:function(_30){this._standby.hide();}});});