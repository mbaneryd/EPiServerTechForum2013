//>>built
define("epi-cms/contentediting/command/ManageExpiration",["dojo/_base/connect","dojo/_base/declare","dojo/_base/Deferred","dojo/_base/lang","epi","epi/datetime","epi-cms/contentediting/ExpirationDialog","epi-cms/contentediting/viewmodel/ExpirationDialogViewModel","epi-cms/contentediting/ContentActionSupport","epi/dependency","epi/shell/command/_Command","epi/shell/widget/dialog/Dialog","epi/i18n!epi/cms/nls/episerver.cms.widget.expirationeditor","epi/i18n!epi/nls/episerver.shared"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e){return _2([_b],{label:_d.dialogtitle,tooltip:_d.dialogtitle,viewModel:null,cssClass:"epi-chromelessButton epi-visibleLink",constructor:function(){this._metadataManager=_a.resolve("epi.shell.MetadataManager");},_execute:function(){if(!this._metadata){return;}var _f=this.get("viewModel");var _10=new _7({metadata:this._metadata,value:_f.get("value"),model:_f});var _11=new _c({destroyOnHide:true,defaultActionsVisible:false,confirmActionText:_e.action.save,content:_10,title:_d.dialogtitle});_11.connect(_11,"onExecute",_4.hitch(this,function(){this._onSave(_11);}));_11.connect(_11,"onCancel",_4.hitch(this,function(){this._onCancel(_11);}));_11.show();},_onModelChange:function(){var _12=this.get("model");if(!_12||!_12.contentData){this.set("canExecute",false);return;}var _13=_12.contentData.properties,_14=_13.iversionable_expire;this.set("viewModel",new _8({contentLink:_12.contentLink,contentName:_12.contentData.name,value:_14,minimumExpireDate:_13.iversionable_startpublish}));var _15=_12.canChangeContent()&&_9.hasAccess(_12.contentData.accessMask,_9.accessLevel.Publish);_3.when(_12.getPropertyMetaData("iversionable_expire"),_4.hitch(this,function(_16){this._metadata=_16;}));this.set("canExecute",_15);},_onSave:function(_17){var _18=_17.content.model,_19=_18.get("intermediateValue");_18.set("value",_19);var _1a=this.get("model");_1a.publishProperty("iversionable_expire",_19);},_onCancel:function(_1b){var _1c=_1b.content.model;_1c.set("intermediateValue",_1c.get("value"));}});});