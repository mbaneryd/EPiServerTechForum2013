(function(){tinymce.create("tinymce.plugins.VisualChars",{init:function(ed){var t=this;t.editor=ed,ed.addCommand("mceVisualChars",t._toggleVisualChars,t),ed.addButton("visualchars",{title:"visualchars.desc",cmd:"mceVisualChars"}),ed.onBeforeGetContent.add(function(ed,o){t.state&&"raw"!=o.format&&!o.draft&&(t.state=!0,t._toggleVisualChars(!1))})},getInfo:function(){return{longname:"Visual characters",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/visualchars",version:tinymce.majorVersion+"."+tinymce.minorVersion}},_toggleVisualChars:function(bookmark){var nl,i,nv,div,bm,t=this,ed=t.editor,b=(ed.getDoc(),ed.getBody()),s=ed.selection;if(t.state=!t.state,ed.controlManager.setActive("visualchars",t.state),bookmark&&(bm=s.getBookmark()),t.state)for(nl=[],tinymce.walk(b,function(n){3==n.nodeType&&n.nodeValue&&-1!=n.nodeValue.indexOf("Â ")&&nl.push(n)},"childNodes"),i=0;nl.length>i;i++){for(nv=nl[i].nodeValue,nv=nv.replace(/(\u00a0)/g,'<span data-mce-bogus="1" class="mceItemHidden mceItemNbsp">$1</span>'),div=ed.dom.create("div",null,nv);node=div.lastChild;)ed.dom.insertAfter(node,nl[i]);ed.dom.remove(nl[i])}else for(nl=ed.dom.select("span.mceItemNbsp",b),i=nl.length-1;i>=0;i--)ed.dom.remove(nl[i],1);s.moveToBookmark(bm)}}),tinymce.PluginManager.add("visualchars",tinymce.plugins.VisualChars)})();