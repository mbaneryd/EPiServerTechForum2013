//>>built
define("dgrid/extensions/ColumnHider",["dojo/_base/declare","dojo/has","dojo/on","../util/misc","put-selector/put","dojo/i18n!./nls/columnHider","xstyle/css!../css/extensions/ColumnHider.css"],function(_1,_2,_3,_4,_5,_6){var _7,_8,_9=_2("ie"),_a=_9&&_2("quirks"),_b=_9<8||_a?"htmlFor":"for";function _c(cb,_d){return cb.id.substr(_d.id.length+18);};return _1(null,{hiderMenuNode:null,hiderToggleNode:null,i18nColumnHider:_6,_hiderMenuOpened:false,_columnHiderRules:null,_columnHiderCheckboxes:null,_renderHiderMenuEntries:function(){var _e=this.subRows,_f=true,_10,_11,sr,c,_12;delete this._columnHiderFirstCheckbox;for(sr=0,_10=_e.length;sr<_10;sr++){for(c=0,_11=_e[sr].length;c<_11;c++){this._renderHiderMenuEntry(_e[sr][c]);if(_f){_f=false;this._columnHiderFirstCheckbox=this._columnHiderCheckboxes[_e[sr][c].id];}}}},_renderHiderMenuEntry:function(col){var id=col.id,div,_13,_14;if(col.hidden){this._hideColumn(id);}if(col.unhidable){return;}div=_5("div.dgrid-hider-menu-row");_13=this.domNode.id+"-hider-menu-check-"+id;this._columnHiderCheckboxes[id]=_14=_5(div,"input#"+_13+".dgrid-hider-menu-check.hider-menu-check-"+id+"[type=checkbox]");_5(div,"label.dgrid-hider-menu-label.hider-menu-label"+id+"["+_b+"="+_13+"]",col.label||col.field||"");_5(this.hiderMenuNode,div);if(!col.hidden){_14.checked=true;}},renderHeader:function(){var _15=this,_16=this.hiderMenuNode,_17=this.hiderToggleNode,id;this.inherited(arguments);if(!_16){_17=this.hiderToggleNode=_5(this.headerScrollNode,"button.ui-icon.dgrid-hider-toggle[type=button]");this._listeners.push(_3(_17,"click",function(e){_15._toggleColumnHiderMenu(e);}));_16=this.hiderMenuNode=_5("div#dgrid-hider-menu-"+this.id+".dgrid-hider-menu[role=dialog][aria-label="+this.i18nColumnHider.popupLabel+"]");this._listeners.push(_3(_16,"keyup",function(e){var _18=e.charCode||e.keyCode;if(_18===27){_15._toggleColumnHiderMenu(e);_17.focus();}}));_16.style.display="none";_5(this.domNode,_16);this._listeners.push(_3(_16,".dgrid-hider-menu-check:"+(_9<9||_a?"click":"change"),function(e){_15._updateColumnHiddenState(_c(e.target,_15),!e.target.checked);}));this._listeners.push(_3(_16,"mousedown",function(e){e.stopPropagation();}));if(!_8){_8=_3.pausable(document,"mousedown",function(e){_7&&_7._toggleColumnHiderMenu(e);});_8.pause();}}else{for(id in this._columnHiderRules){this._columnHiderRules[id].remove();}_16.innerHTML="";}this._columnHiderCheckboxes={};this._columnHiderRules={};this._renderHiderMenuEntries();},destroy:function(){this.inherited(arguments);for(var id in this._columnHiderRules){this._columnHiderRules[id].remove();}},isColumnHidden:function(id){return !!this._columnHiderRules[id];},_toggleColumnHiderMenu:function(){var _19=this._hiderMenuOpened,_1a=this.hiderMenuNode,_1b=this.domNode,_1c;_1a.style.display=(_19?"none":"");if(_19){_1a.style.height="";}else{if(_1a.offsetHeight>_1b.offsetHeight-12){_1a.style.height=(_1b.offsetHeight-12)+"px";}(_1c=this._columnHiderFirstCheckbox)&&_1c.focus();}_8[_19?"pause":"resume"]();_7=_19?null:this;this._hiderMenuOpened=!_19;},_hideColumn:function(id){var _1d="#"+_4.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-",_1e;if(this._columnHiderRules[id]){return;}this._columnHiderRules[id]=_4.addCssRule(_1d+id,"display: none;");if(_2("ie")===8&&!_2("quirks")){_1e=_4.addCssRule(".dgrid-row-table","display: inline-table;");window.setTimeout(function(){_1e.remove();},0);}},_updateColumnHiddenState:function(id,_1f){if(!_1f){this._columnHiderRules[id]&&this._columnHiderRules[id].remove();delete this._columnHiderRules[id];}else{this._hideColumn(id);}this.columns[id].hidden=_1f;_3.emit(this.domNode,"dgrid-columnstatechange",{grid:this,column:this.columns[id],hidden:_1f,bubbles:true});this.resize();},toggleColumnHiddenState:function(id,_20){if(typeof _20==="undefined"){_20=!this._columnHiderRules[id];}this._updateColumnHiddenState(id,_20);this._columnHiderCheckboxes[id].checked=!_20;}});});