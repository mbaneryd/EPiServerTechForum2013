//>>built
define("epi/shell/_ContextMixin",["dojo/_base/declare","dojo/_base/lang","dojo/Deferred","dojo/topic","dijit/Destroyable"],function(_1,_2,_3,_4,_5){return _1([_5],{_currentContext:null,_waitingForContext:null,constructor:function(_6){this.own(_4.subscribe("/epi/shell/context/changed",_2.hitch(this,this._contextChanged)),_4.subscribe("/epi/shell/context/updated",_2.hitch(this,function(_7,_8){this._currentContext=_7;this.contextUpdated(_7,_8);})),_4.subscribe("/epi/shell/context/requestfailed",_2.hitch(this,"contextChangeFailed")));var _9=this.own(_4.subscribe("/epi/shell/context/current",_2.hitch(this,function(_a,_b){if(this._currentContext||!_b||_b.sender!==this){return;}_9.remove();this._initialContextChanged(_a,_b);})))[0];_4.publish("/epi/shell/context/requestcurrent",{sender:this});},getCurrentContext:function(){if(this._currentContext!=null){return this._currentContext;}if(!this._waitingForContext){this._waitingForContext=new _3();}return this._waitingForContext.promise;},contextChanged:function(_c,_d){},contextUpdated:function(_e,_f){},contextChangeFailed:function(ctx,_10){},_contextChanged:function(_11,_12){if(!this._currentContext){this._initialContextChanged(_11,_12);}this._currentContext=_11;this.contextChanged(_11,_12);},_initialContextChanged:function(_13,_14){this._currentContext=_13;if(this._waitingForContext){this._waitingForContext.resolve(_13);delete this._waitingForContext;}}});});