(function(){var each=tinymce.each;tinymce.create("tinymce.plugins.AdvListPlugin",{init:function(ed){function buildFormats(str){var formats=[];return each(str.split(/,/),function(type){formats.push({title:"advlist."+("default"==type?"def":type.replace(/-/g,"_")),styles:{listStyleType:"default"==type?"":type}})}),formats}var t=this;t.editor=ed,t.numlist=ed.getParam("advlist_number_styles")||buildFormats("default,lower-alpha,lower-greek,lower-roman,upper-alpha,upper-roman"),t.bullist=ed.getParam("advlist_bullet_styles")||buildFormats("default,circle,disc,square"),tinymce.isIE&&/MSIE [2-7]/.test(navigator.userAgent)&&(t.isIE7=!0)},createControl:function(name,cm){function hasFormat(node,format){var state=!0;return each(format.styles,function(value,name){return editor.dom.getStyle(node,name)!=value?(state=!1,!1):void 0}),state}function applyListFormat(){var list,dom=editor.dom,sel=editor.selection;list=dom.getParent(sel.getNode(),"ol,ul"),(!list||list.nodeName==("bullist"==name?"OL":"UL")||hasFormat(list,format))&&editor.execCommand("bullist"==name?"InsertUnorderedList":"InsertOrderedList"),format&&(list=dom.getParent(sel.getNode(),"ol,ul"),list&&(dom.setStyles(list,format.styles),list.removeAttribute("data-mce-style"))),editor.focus()}var btn,format,t=this,editor=t.editor;return"numlist"==name||"bullist"==name?("advlist.def"==t[name][0].title&&(format=t[name][0]),btn=cm.createSplitButton(name,{title:"advanced."+name+"_desc","class":"mce_"+name,onclick:function(){applyListFormat()}}),btn.onRenderMenu.add(function(btn,menu){menu.onHideMenu.add(function(){t.bookmark&&(editor.selection.moveToBookmark(t.bookmark),t.bookmark=0)}),menu.onShowMenu.add(function(){var fmtList,dom=editor.dom,list=dom.getParent(editor.selection.getNode(),"ol,ul");(list||format)&&(fmtList=t[name],each(menu.items,function(item){var state=!0;item.setSelected(0),list&&!item.isDisabled()&&(each(fmtList,function(fmt){return fmt.id!=item.id||hasFormat(list,fmt)?void 0:(state=!1,!1)}),state&&item.setSelected(1))}),list||menu.items[format.id].setSelected(1)),editor.focus(),tinymce.isIE&&(t.bookmark=editor.selection.getBookmark(1))}),menu.add({id:editor.dom.uniqueId(),title:"advlist.types","class":"mceMenuItemTitle",titleItem:!0}).setDisabled(1),each(t[name],function(item){t.isIE7&&"lower-greek"==item.styles.listStyleType||(item.id=editor.dom.uniqueId(),menu.add({id:item.id,title:item.title,onclick:function(){format=item,applyListFormat()}}))})}),btn):void 0},getInfo:function(){return{longname:"Advanced lists",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/advlist",version:tinymce.majorVersion+"."+tinymce.minorVersion}}}),tinymce.PluginManager.add("advlist",tinymce.plugins.AdvListPlugin)})();