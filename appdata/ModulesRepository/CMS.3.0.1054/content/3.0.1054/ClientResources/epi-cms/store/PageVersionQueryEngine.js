//>>built
define("epi-cms/store/PageVersionQueryEngine",["dojo/_base/array","epi-cms/core/ContentReference"],function(_1,_2){return function(_3,_4){switch(typeof _3){case "object":case "undefined":var _5=_3;_3=function(_6){for(var _7 in _5){var _8,_9=_5[_7],_a=_9.toString();if(_a.indexOf("_")>=0){_8=new _2(_a);_9=RegExp("^"+_8.id+"_.*$");}if(_9&&_9.test){if(!_9.test(_6[_7])){return false;}}else{if(_9!=_6[_7]){return false;}}}return true;};break;case "string":if(!this[_3]){throw new Error("No filter function "+_3+" was found in store");}_3=this[_3];break;case "function":break;default:throw new Error("Can not query with a "+typeof _3);}function _b(_c){var _d=_1.filter(_c,_3);if(_4&&_4.sort){_d.sort(function(a,b){for(var _e,i=0;_e=_4.sort[i];i++){var _f=a[_e.attribute];var _10=b[_e.attribute];if(_f!=_10){return _e.descending==(_f>_10)?-1:1;}}return 0;});}if(_4&&(_4.start||_4.count)){var _11=_d.length;_d=_d.slice(_4.start||0,(_4.start||0)+(_4.count||Infinity));_d.total=_11;}return _d;};_b.matches=_3;return _b;};});