//>>built
define("epi-cms/contentediting/viewmodel/ContentAreaViewModel",["dojo/_base/array","dojo/_base/declare","dojo/_base/lang","epi-cms/contentediting/viewmodel/ContentBlockViewModel","epi-cms/contentediting/viewmodel/PersonalizedGroupViewModel","epi-cms/contentediting/viewmodel/_ContainerViewModel"],function(_1,_2,_3,_4,_5,_6){return _2([_6],{selectedItem:null,addChild:function(_7){if(!(_7 instanceof _4)&&!(_7 instanceof _5)){var _8=new _4(_7);this.own(_8.watch("roleIdentities",_3.hitch(this,function(){this.emit("changed");})));if(_8.contentGroup){_7=this._groups[_8.contentGroup];if(!_7){_7=this._createGroup(_8.contentGroup);}_7.addChild(_8);}else{_7=_8;}}else{_7.set("contentGroup",null);if(_7 instanceof _5){this.own(_7.on("childrenChanged",_3.hitch(this,function(){this._emitChildrenChanged(_7);if(_7.getChildren().length===0){this.removeChild(_7);}})));}else{if(_7 instanceof _4){_7.resetRoleIdentities();}}}this.own(_7.on("changed",_3.hitch(this,function(){this.emit("changed");})));this.inherited(arguments);this._handles[_7.id]=_7.on("selected",_3.hitch(this,"set","selectedItem"));},moveVisible:function(_9,_a){var _b=_1.filter(this.getChildren(),function(_c){return _c.get("visible");}),_d=_a?1:-1,_e=_1.indexOf(_b,_9)+_d,_f=this.indexOf(_b[_e]);this.modify(_3.hitch(this,function(){this.move(_9,_f);}));},moveOutsideGroup:function(_10){if(!_10.contentGroup){return;}var _11=this.getChild({name:_10.contentGroup}),_12=this.indexOf(_11);this.modify(_3.hitch(this,function(){_11.removeChild(_10);this.addChild(_10,_12);}));},personalize:function(_13){var _14=this.indexOf(_13);this.removeChild(_13);var _15=new _5({name:"group_"+Date.now(),expandOnAdd:true});_13.set("ensurePersonalization",true);_15.addChild(_13);this.addChild(_15,_14);},_valueGetter:function(){var _16=[];_1.forEach(this.getChildren(),function(_17){_16=_16.concat(_17.serialize());});return _16;},_valueSetter:function(_18){this._transformValueToModels(_18);},_selectedItemSetter:function(_19){if(this.selectedItem){this.selectedItem.set("selected",false);}this.selectedItem=_19;},_transformValueToModels:function(_1a){this.modify(function(){var _1b=this.getChildren();for(var i=_1b.length-1;i>=0;i--){this.removeChild(_1b[i]);}this._groups={};_1.forEach(_1a,function(_1c){var _1d=new _4(_1c);this.own(_1d.watch("roleIdentities",_3.hitch(this,function(){this.emit("changed");})));if(_1d.contentGroup){var _1e=this._groups[_1d.contentGroup];if(!_1e){_1e=this._createGroup(_1d.contentGroup);this.addChild(_1e);}_1e.addChild(_1d,_1e.getChildren().length);}else{this.addChild(_1d);}},this);},this,false);},_createGroup:function(_1f){var _20=new _5({name:_1f});this._groups[_1f]=_20;return _20;},_hash:function(_21){return (_21.contentLink||_21.name)+"_"+Date.now();}});});