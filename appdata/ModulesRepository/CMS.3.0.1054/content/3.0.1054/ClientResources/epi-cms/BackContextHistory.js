//>>built
define("epi-cms/BackContextHistory",["dojo/_base/declare","dojo/_base/lang","dojo/store/Memory","epi/shell/ContextHistory"],function(_1,_2,_3,_4){return _1([_4],{createStore:function(){return new _3({data:[],idProperty:"index"});},onContextChanged:function(_5,_6,_7){if(_6&&_6.trigger==="back"){this._removeLastItem();return;}this.inherited(arguments);},getPrevious:function(){var _8=this.store.query({},{count:2,sort:[{attribute:"dateAdded",descending:true}]});return (_8&&_8.length>1)?_8[1]:null;},_updateStore:function(_9){var _a=this._getLastItem();if(_a&&_a.uri===_9.versionAgnosticUri){return;}this.inherited(arguments);},_getLastItem:function(){if(this.store&&this.store.data&&this.store.data.length>0){return this.store.data[this.store.data.length-1];}return null;},_removeLastItem:function(){var _b=this._getLastItem();if(_b){this.store.remove(this.store.getIdentity(_b));}}});});