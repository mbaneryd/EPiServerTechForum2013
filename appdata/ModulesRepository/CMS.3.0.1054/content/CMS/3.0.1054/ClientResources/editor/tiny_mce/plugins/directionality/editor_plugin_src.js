(function(){tinymce.create("tinymce.plugins.Directionality",{init:function(ed){function setDir(dir){var curDir,dom=ed.dom,blocks=ed.selection.getSelectedBlocks();blocks.length&&(curDir=dom.getAttrib(blocks[0],"dir"),tinymce.each(blocks,function(block){dom.getParent(block.parentNode,"*[dir='"+dir+"']",dom.getRoot())||(curDir!=dir?dom.setAttrib(block,"dir",dir):dom.setAttrib(block,"dir",null))}),ed.nodeChanged())}var t=this;t.editor=ed,ed.addCommand("mceDirectionLTR",function(){setDir("ltr")}),ed.addCommand("mceDirectionRTL",function(){setDir("rtl")}),ed.addButton("ltr",{title:"directionality.ltr_desc",cmd:"mceDirectionLTR"}),ed.addButton("rtl",{title:"directionality.rtl_desc",cmd:"mceDirectionRTL"}),ed.onNodeChange.add(t._nodeChange,t)},getInfo:function(){return{longname:"Directionality",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/directionality",version:tinymce.majorVersion+"."+tinymce.minorVersion}},_nodeChange:function(ed,cm,n){var dir,dom=ed.dom;return(n=dom.getParent(n,dom.isBlock))?(dir=dom.getAttrib(n,"dir"),cm.setActive("ltr","ltr"==dir),cm.setDisabled("ltr",0),cm.setActive("rtl","rtl"==dir),cm.setDisabled("rtl",0),void 0):(cm.setDisabled("ltr",1),cm.setDisabled("rtl",1),void 0)}}),tinymce.PluginManager.add("directionality",tinymce.plugins.Directionality)})();