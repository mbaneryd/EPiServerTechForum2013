//>>built
define("epi-cms/contentediting/editors/SelectionEditor",["dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/dom-class","dojo/on","dijit/form/Select","dijit/MenuItem","dijit/MenuSeparator","epi/shell/layout/_LayoutWidget","epi/shell/widget/_ValueRequiredMixin"],function(_1,_2,_3,_4,on,_5,_6,_7,_8,_9){return _2([_8,_5,_9],{actualValue:null,value:null,maxHeight:-1,postMixInProperties:function(){this.inherited(arguments);this.set("selections",this.selections);this.actualValue=this.value;},_setSelectionsAttr:function(_a){this.set("options",_1.map(_a,function(_b){return {label:_b.text,value:_b.value,selected:(_b.value==this.value)||(!_b.value&&!this.value)};},this));},postCreate:function(){this.inherited(arguments);on(this,"change",_3.hitch(this,function(){this.validate();this.onLayoutChanged();}));},_getMenuItemForOption:function(_c){if(_c.type=="separator"){return new _7();}else{var _d=_3.hitch(this,"_setValueAttr",_c);var _e=new _6({option:_c,label:_c.label||this.emptyLabel,onClick:_d,disabled:_c.disabled||false});_e.focusNode.setAttribute("role","listitem");return _e;}},_getValueFromOpts:function(){var _f=this.getOptions()||[];if(!this.multiple&&_f.length){var _10=_1.filter(_f,function(i){return i.selected;})[0];if(_10&&_10.value!==undefined){return _10.value;}else{return null;}}else{if(this.multiple){return _1.map(_1.filter(_f,function(i){return i.selected;}),function(i){return i.value;})||[];}}return "";},_setValueAttr:function(_11,_12){var _13=this.getOptions()||[];if(_11===null||typeof _11!="object"){_11=_1.filter(_13,function(i){return (i.value==_11)||(!i.value&&!_11);});}if(!_3.isArray(_11)){_11=[_11];}if(this._onChangeActive){var _14=_11[0]?_11[0].value:null;this._pendingOnChange=this.actualValue!==_14;this.actualValue=_14;}_1.forEach(_13,function(i){i.selected=_1.some(_11,function(v){return v.value===i.value;});});var val=_1.map(_11,function(i){return i.value;}),_15=_1.map(_11,function(i){return i.label;});this._set("value",this.multiple?val:val[0]);this._setDisplay(this.multiple?_15:_15[0]);this._updateSelection();this._handleOnChange(this.value,_12);},_updateSelection:function(){this._set("value",this._getValueFromOpts());var _16=this.value;if(_16!==undefined){if(!_3.isArray(_16)){_16=[_16];}_1.forEach(this._getChildren(),function(_17){var _18=_1.some(_16,function(v){return _17.option&&(v===_17.option.value);});_17.domNode.setAttribute("aria-selected",_18);},this);}},validator:function(_19,_1a){}});});