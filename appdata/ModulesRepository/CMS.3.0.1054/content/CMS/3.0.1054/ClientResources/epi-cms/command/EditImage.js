//>>built
define("epi-cms/command/EditImage",["dojo/_base/declare","dojo/_base/lang","dojo/when","dojo/topic","epi/dependency","epi/routes","epi/Url","epi/shell/TypeDescriptorManager","epi-cms/ApplicationSettings","epi-cms/core/ContentReference","epi-cms/core/PermanentLinkHelper","epi-cms/legacy/LegacyDialogPopup","epi-cms/contentediting/command/_LegacyDialogCommandBase","epi/shell/command/_SelectionCommandMixin","epi-cms/contentediting/ContentActionSupport"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f){return _1([_d,_e],{canExecute:false,iconClass:"epi-iconNewWindow",_segmentIdSeperator:",,",getRouteParams:function(){var _10=this._getTarget();return {moduleArea:"LegacyCMS",path:"Edit/ImageEditor/ImageEditor.aspx",IsInLegacyWrapper:false,imageId:_10?_10.contentLink:""};},_createDialog:function(_11,_12){var _13=this._getTarget(),_14=this.model;if(_13){var _15=function(_16){if(_16){_4.publish("/epi/shell/context/request",{url:_16.src},{forceReload:true});}};_2.mixin(_11,{url:_6.getActionPath(_12),dialogArguments:{src:_b.toPermanentLink(_13)},destroyOnHide:true,onCallback:_15});}return new _c(_11);},_onModelChange:function(){if(!_9.imageEditorEnabled){if(this.get("isAvailable")){this.set("isAvailable",false);}return;}var _17=this._getTarget(),_18=this.model&&_17&&_8.isBaseTypeIdentifier(_17.typeIdentifier,"episerver.core.icontentimage");this.set("canExecute",!!_18);},_getTarget:function(){var _19=this.selection&&this.selection.data,_1a=_19&&_19.length==1&&_19[0];return _1a&&(_1a.type=="epi.cms.contentdata")?_1a.data:null;}});});